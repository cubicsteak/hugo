{{ $pag := .Paginator }}

{{ if gt $pag.TotalPages 1 }}
<nav aria-label="Page navigation" class="mt-5">
  <ul class="pagination pagination-sm justify-content-center">

    <li class="page-item {{ if eq $pag.PageNumber 1 }}disabled{{ end }}">
      <a class="page-link" href="{{ if ne $pag.PageNumber 1 }}{{ $pag.First.URL }}{{ else }}#{{ end }}" aria-label="First">
        <span aria-hidden="true"><i class="bi bi-chevron-double-left"></i></span>
      </a>
    </li>

    <li class="page-item {{ if not $pag.HasPrev }}disabled{{ end }}">
      <a class="page-link" href="{{ if $pag.HasPrev }}{{ $pag.Prev.URL }}{{ else }}#{{ end }}"><i class="bi bi-chevron-left"></i></a>
    </li>

    {{ $adjacent_links := 2 }}
    {{ $max_links := (add (mul $adjacent_links 2) 1) }}
    {{ $lower_limit := (add $adjacent_links 1) }}
    {{ $upper_limit := (sub $pag.TotalPages $adjacent_links) }}

    {{ range $pag.Pagers }}
      {{ $.Scratch.Set "show" false }}
      {{ if gt $pag.TotalPages $max_links }}
        {{ if le $pag.PageNumber $lower_limit }}
          {{ if le .PageNumber $max_links }} {{ $.Scratch.Set "show" true }} {{ end }}
        {{ else if ge $pag.PageNumber $upper_limit }}
          {{ if gt .PageNumber (sub $pag.TotalPages $max_links) }} {{ $.Scratch.Set "show" true }} {{ end }}
        {{ else }}
          {{ if and (ge .PageNumber (sub $pag.PageNumber $adjacent_links)) (le .PageNumber (add $pag.PageNumber $adjacent_links)) }}
            {{ $.Scratch.Set "show" true }}
          {{ end }}
        {{ end }}
      {{ else }}
        {{ $.Scratch.Set "show" true }}
      {{ end }}

      {{ if eq ($.Scratch.Get "show") true }}
      <li class="page-item {{ if eq .PageNumber $pag.PageNumber }}active{{ end }}">
        <a class="page-link" href="{{ .URL }}">{{ .PageNumber }}</a>
      </li>
      {{ end }}
    {{ end }}

    <li class="page-item {{ if not $pag.HasNext }}disabled{{ end }}">
      <a class="page-link" href="{{ if $pag.HasNext }}{{ $pag.Next.URL }}{{ else }}#{{ end }}"><i class="bi bi-chevron-right"></i></a>
    </li>

    <li class="page-item {{ if eq $pag.PageNumber $pag.TotalPages }}disabled{{ end }}">
      <a class="page-link" href="{{ if ne $pag.PageNumber $pag.TotalPages }}{{ $pag.Last.URL }}{{ else }}#{{ end }}" aria-label="Last">
        <span aria-hidden="true"><i class="bi bi-chevron-double-right"></i></span>
      </a>
    </li>

  </ul>
</nav>
{{ end }}